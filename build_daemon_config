#!/bin/false

if echo "${CONFIG}" | grep -q 32; then
  MINGW_W64_TRIPLET="i686-w64-mingw32"
  BITS="32"
else
  MINGW_W64_TRIPLET="x86_64-w64-mingw32"
  BITS="64"
fi

CROSS_TOOLCHAIN="cross_toolchain_${BITS}"
TARGET_PREFIX="windows_${BITS}"

export BUILD_TRIPLET="x86_64-slackware-linux"

export YYPREFIX_CROSS_TOOLCHAIN="/opt/${CROSS_TOOLCHAIN}"
export YYPREFIX_TARGET_PREFIX="/opt/${TARGET_PREFIX}"

if echo "${CONFIG}" | grep -q cross_toolchain; then
  export HOST_TRIPLET="${BUILD_TRIPLET}"
  export HOST_STRIP="strip"
  export HOST_EXE_FORMAT="ELF"
  export YYPREFIX="${YYPREFIX_CROSS_TOOLCHAIN}"
  export PATH="${YYPREFIX}/bin:${PATH}"
else
  export HOST_TRIPLET="${MINGW_W64_TRIPLET}"
  export HOST_STRIP="${HOST_TRIPLET}-strip"
  export HOST_EXE_FORMAT="PE"
  export YYPREFIX="${YYPREFIX_TARGET_PREFIX}"
  export PATH="/opt/${CROSS_TOOLCHAIN}/bin:${YYPREFIX}/bin:${PATH}"
  export PKG_CONFIG_LIBDIR="${YYPREFIX}/lib/pkgconfig"
fi

export PATH="/usr/local/bin:$(echo "${PATH}" | sed -e 's;/usr/local/bin:;;g')"

export TARGET_TRIPLET="${MINGW_W64_TRIPLET}"
export TARGET_STRIP="${TARGET_TRIPLET}-strip"
export TARGET_EXE_FORMAT="PE"

export YYOUTPUT="${CWD}/packages/${CONFIG}"
