#!/bin/false

export BUILD_TRIPLET="x86_64-slackware-linux"

export YYPREFIX_NATIVE_TOOLCHAIN="/opt/native_toolchain"

if [ x"${CONFIG}" = x"native_toolchain" ]; then
  NICKNAME="native_toolchain"
  export HOST_TRIPLET="${BUILD_TRIPLET}"
  export HOST_STRIP="strip"
  export HOST_EXE_FORMAT="ELF"
  export TARGET_TRIPLET="${BUILD_TRIPLET}"
  export TARGET_STRIP="strip"
  export TARGET_EXE_FORMAT="ELF"
  export LIBDIRSUFFIX="64"
  export YYPREFIX="${YYPREFIX_NATIVE_TOOLCHAIN}"
  export PATH="${YYPREFIX}/bin:${PATH}"
  export PKG_CONFIG_PATH="${YYPREFIX}/lib${LIBDIRSUFFIX}/pkgconfig"
else
  case "${CONFIG}" in
    *-i686-w64-mingw32) 
      MINGW_W64_TRIPLET="i686-w64-mingw32"; BITS="32";
      export LIBDIRSUFFIX="";;
    *-x86_64-w64-mingw32)
      MINGW_W64_TRIPLET="x86_64-w64-mingw32"; BITS="64";
      export LIBDIRSUFFIX="64";;
  esac
  NICKNAME_CROSS_TOOLCHAIN="cross_toolchain_${BITS}"
  NICKNAME_WINDOWS="windows_${BITS}"
  export YYPREFIX_CROSS_TOOLCHAIN="/opt/${NICKNAME_CROSS_TOOLCHAIN}"
  export YYPREFIX_TARGET_PREFIX="/opt/${NICKNAME_WINDOWS}"
  export TARGET_TRIPLET="${MINGW_W64_TRIPLET}"
  export TARGET_STRIP="${TARGET_TRIPLET}-strip"
  export TARGET_EXE_FORMAT="PE"
  case "${CONFIG}" in
    cross_toolchain-*)
      NICKNAME="${NICKNAME_CROSS_TOOLCHAIN}"
      export HOST_TRIPLET="${BUILD_TRIPLET}"
      export HOST_STRIP="strip"
      export HOST_EXE_FORMAT="ELF"
      export YYPREFIX="${YYPREFIX_CROSS_TOOLCHAIN}"
      export PATH="${YYPREFIX}/bin:${YYPREFIX_NATIVE_TOOLCHAIN}/bin:${PATH}" ;;
    windows-*)
      NICKNAME="${NICKNAME_WINDOWS}"
      export HOST_TRIPLET="${MINGW_W64_TRIPLET}"
      export HOST_STRIP="${HOST_TRIPLET}-strip"
      export HOST_EXE_FORMAT="PE"
      export YYPREFIX="${YYPREFIX_TARGET_PREFIX}"
      # ${YYPREFIX_TARGET_PREFIX}/bin has to be in $PATH because otherwise
      # libtool won't find libraries without being given an additional -L
      # switch.  Setting it by hand everywhere would be too much work and would
      # actually be ugly hardcoding so put the directory in $PATH even if
      # that's a bit ugly.
      export PATH="${YYPREFIX_CROSS_TOOLCHAIN}/bin:${YYPREFIX_NATIVE_TOOLCHAIN}/bin:${PATH}:${YYPREFIX_TARGET_PREFIX}/bin"
      export PKG_CONFIG_LIBDIR="${YYPREFIX}/lib${LIBDIRSUFFIX}/pkgconfig"
      export -n PKG_CONFIG_PATH ;;
  esac
fi

export LOGS="${CWD}/logs/${NICKNAME}"
export YYOUTPUT="${CWD}/packages/${NICKNAME}"
export PROCESSING="${CWD}/processing/${HOST_TRIPLET}-${TARGET_TRIPLET}"
