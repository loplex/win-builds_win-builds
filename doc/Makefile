include ../Makefile.data

HOST:=notk.org:/var/www/win-builds.org/$(VERSION)

DOCS:=index diy packaging msys
DOCS_TXT:=$(DOCS:%=%.txt)
DOCS_HTML:=$(DOCS:%=%.html)

version.config: ../Makefile.data Makefile
	echo '[blockdef-listing]' > $@
	echo 'subs=specialcharacters,callouts,replacements' >> $@
	echo '[replacements]' >> $@
	echo '@@VERSION@@=$(VERSION)' >> $@

%.html: %.txt version.config
	a2x -f xhtml \
	  --stylesheet="docbook-xsl.css style.css" \
	  --resource=../web \
	  --asciidoc-opts="--conf-file version.config" \
	  $<

doc: $(DOCS_HTML)

doc-upload: doc
	rsync -avP $(DOCS_HTML) $(DOCS_TXT) docbook-xsl.css $(HOST)/

clean:
	rm -f $(DOCS_HTML)
