#!/bin/sh -eux

SLACKBUILD="${1}"

# If compiling a native program
if [ "${BUILD_TRIPLET}" = "${HOST_TRIPLET}" ]; then
  STRIP="strip"
  if echo "${HOST_TRIPLET}" | grep -q slackware-linux; then
    EXE_FORMAT="ELF"
  fi
else # cross-compiling
  if echo "${HOST_TRIPLET}" | grep -q 'i.86'; then
    LIBDIRSUFIX=""
  elif echo "${HOST_TRIPLET}" | grep -q 'x86_64'; then
    LIBDIRSUFIX="64"
  fi
  if echo "${HOST_TRIPLET}" | grep 'mingw'; then
    EXE_FORMAT="PE"
  fi
  STRIP=${HOST_TRIPLET}-strip
  export PKG_CONFIG_LIBDIR=${YYPREFIX}/lib${LIBDIRSUFIX}/pkgconfig
fi

export EXE_FORMAT STRIP
export PREFIX="$(echo "${YYPREFIX}" | sed -e 's;^/;;')"

/bin/sh -x ${SLACKBUILD}

